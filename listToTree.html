<script>
    let arr=[
        {id:1,name:'部门1',pid:0},
        {id:2,name:'部门1',pid:0},
        {id:1,name:'部门1',pid:0},
        {id:1,name:'部门1',pid:0},
        {id:1,name:'部门1',pid:0},
        {id:1,name:'部门1',pid:0},
    ]
    function listToTree(rootList,id,list){
        for(const item of rootList){
            if(item.pid==id){
                list.push(item)
            }
        }
        for(const i of list){
            i.children=[]
            listToTree(rootList,i.id,i.children)
            if(i.children.length==0){
                delete i.children
            }
        }
        return list
    }
    const res=listToTree(arr,0,[])
    console.log('res',JSON.stringify(res,null,2))
</script>