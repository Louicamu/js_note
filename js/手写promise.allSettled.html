<script>
    function allSettled(promises){
        return Promise.all(promises.map((p)=>{
            Promise.resolve(p).then(
                value=>({status:'fulfilled',value}),
                reason=>({status:'rejected',reason})
            )
        }))
    }

//无论成功失败都等待所有promise完成
</script>